# Script to fit source region for 0087940201 (all exposures)
# and 0551000201 (MOS1,2 only)
# Using straight background subtraction procedure + ad hoc ARF correction

cpd /xw
setplot en
abund wilm
query yes

# Data import + response set-up
# -----------------------------

# EXPERIMENTAL...
data 1:1 0087940201/odf/repro/mos1S001_src_sqpb_sbkg_grp25.pi 
data 2:2 0087940201/odf/repro/mos2S002_src_sqpb_sbkg_grp25.pi 
data 3:3 0087940201/odf/repro/pnS003_src_os_sqpb_sbkg_grp25.pi
data 4:4 0551000201/odf/repro/mos1S001_src_sqpb_sbkg_grp25.pi 
data 5:5 0551000201/odf/repro/mos2S002_src_sqpb_sbkg_grp25.pi 

#data 1:1 0087940201/odf/repro/mos1S001_src_sqpb_sbkg_grp50.pi 
#data 2:2 0087940201/odf/repro/mos2S002_src_sqpb_sbkg_grp50.pi 
#data 3:3 0087940201/odf/repro/pnS003_src_os_sqpb_sbkg_grp50.pi
#data 4:4 0551000201/odf/repro/mos1S001_src_sqpb_sbkg_grp50.pi 
#data 5:5 0551000201/odf/repro/mos2S002_src_sqpb_sbkg_grp50.pi 

#data 1:1 0087940201/odf/repro/mos1S001_src_sbkg_grp50.pi 
#data 2:2 0087940201/odf/repro/mos2S002_src_sbkg_grp50.pi 
#data 3:3 0087940201/odf/repro/pnS003_src_os_sbkg_grp50.pi
#data 4:4 0551000201/odf/repro/mos1S001_src_sbkg_grp50.pi 
#data 5:5 0551000201/odf/repro/mos2S002_src_sbkg_grp50.pi 

resp 1 0087940201/odf/repro/mos1S001-src.rmf
resp 2 0087940201/odf/repro/mos2S002-src.rmf
resp 3 0087940201/odf/repro/pnS003-src.rmf
resp 4 0551000201/odf/repro/mos1S001-src.rmf
resp 5 0551000201/odf/repro/mos2S002-src.rmf

arf 1 0087940201/odf/repro/mos1S001-src.arf
arf 2 0087940201/odf/repro/mos2S002-src.arf
arf 3 0087940201/odf/repro/pnS003-src.arf
arf 4 0551000201/odf/repro/mos1S001-src.arf
arf 5 0551000201/odf/repro/mos2S002-src.arf

# Model parameter set-up
# ----------------------
# Note: keep model definition + initial freeze/thaw commands together
# That way, easier to mentally link parameters and their numbers

# 1 = TBabs nH
# 2 = vnei kT
# 3-15 = vnei abundances (H,He,C,...,Ni); 10=Si, 11=S
# 16 = vnei Tau
# 17 = vnei redshift
# 18 = vnei norm
mo tbabs*vnei
    1
    1
    1
    1
    1
    1
    1
    1
    1
    1
    1
    1
    1
    1
    1
    1e11
    0
    1

# Hold to defaults for initial fit, before varying vnei/tbabs parameters
freeze 1,2,16


# Prepare to fit
# --------------
notice all
ignore 1:**-0.3,11.0-**
ignore 2:**-0.3,11.0-**
ignore 3:**-0.4,11.0-**
ignore 4:**-0.3,11.0-**
ignore 5:**-0.3,11.0-**
ignore bad

# FIRST FIT with only SNR norm free
fit

# Thaw kT, nH, Tau, then S and Si if appropriate (by hand)
#thaw 1,2,16
#fit

#thaw snr:10
#fit
#pl ld delch
#thaw snr:11
#fit
#pl ld delch
